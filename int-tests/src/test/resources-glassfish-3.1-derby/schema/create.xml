<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd" logicalFilePath="jeewcslib-commons">
    
    <changeSet id="drop-tables-using-procedure" author="kumm">
        <sql>
CREATE PROCEDURE DROP_TABLE(IN schemaName varchar(128), IN tableName varchar(128)) PARAMETER STYLE JAVA MODIFIES SQL DATA LANGUAGE JAVA EXTERNAL NAME 'org.jboss.arquillian.integration.persistence.datasource.derby.DerbyDropTable.dropTable';
CALL DROP_TABLE('app', 'SEQUENCE');
CALL DROP_TABLE('app', 'ADDRESS');
CALL DROP_TABLE('app', 'USERACCOUNT');
CALL DROP_TABLE('app', 'USERACCOUNT_ADDRESS');
DROP PROCEDURE DROP_TABLE;
        </sql>
    </changeSet>
    
    <changeSet id="create-table-address" author="kumm">
        <sql>
CREATE TABLE address (ID BIGINT NOT NULL, CITY VARCHAR(255), HOUSENUMBER INTEGER, STREETNAME VARCHAR(255), VERSION BIGINT, ZIPCODE INTEGER, PRIMARY KEY (ID));
        </sql>
    </changeSet>

    <changeSet id="create-table-useraccount" author="kumm">
        <sql>
CREATE TABLE useraccount (ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, FIRSTNAME VARCHAR(255), LASTNAME VARCHAR(255), NICKNAME VARCHAR(255), OPENDATE DATE, PASSWORD VARCHAR(255), USERNAME VARCHAR(255), PRIMARY KEY (ID));
        </sql>
    </changeSet>    

    <changeSet id="create-table-useraccount_address" author="kumm">
        <sql>
CREATE TABLE useraccount_address (UserAccount_ID BIGINT NOT NULL, addresses_ID BIGINT NOT NULL, PRIMARY KEY (UserAccount_ID, addresses_ID));
        </sql>
    </changeSet>
    
     <changeSet id="alter-table-useraccount_address-1" author="kumm">
         <sql>
ALTER TABLE useraccount_address ADD CONSTRAINT srccntddrssddrsssD FOREIGN KEY (addresses_ID) REFERENCES address (ID);
         </sql>
     </changeSet> 

     <changeSet id="alter-table-useraccount_address-2" author="kumm">
         <sql>
ALTER TABLE useraccount_address ADD CONSTRAINT srccntddrsssrccntD FOREIGN KEY (UserAccount_ID) REFERENCES useraccount (ID);
         </sql>
     </changeSet> 
     
     <changeSet id="create-and-init-sequence-table" author="kumm">
         <sql>
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(15), PRIMARY KEY (SEQ_NAME));
INSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0);
         </sql>
     </changeSet> 
     
</databaseChangeLog>